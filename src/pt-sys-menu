#!/usr/bin/env python3
# -*- coding: utf-8 -*-
from components.MenuManager import MenuManager
from signal import (
    signal,
    SIGINT,
    SIGTERM
)
from logging import (
    basicConfig,
    getLogger,
    DEBUG,
    ERROR
)
from ptcommon.logger import PTLogger


def configure_logging():
    basicConfig(
        level=DEBUG,
        format='%(asctime)-15s - %(message)s'
    )
    # Ignore PIL debug messages
    getLogger('PIL').setLevel(ERROR)


def configure_interrupt_signals():
    def signal_handler(signal, frame):
        PTLogger.debug("Stopping...")
        app.stop()
        PTLogger.debug("Stopped!")
    signal(SIGINT, signal_handler)
    signal(SIGTERM, signal_handler)


def setup():
    configure_logging()
    configure_interrupt_signals()


if __name__ == "__main__":
    try:
        setup()
        app = MenuManager()
        app.main_loop()
        app.stop()
    except KeyboardInterrupt:
        pass
